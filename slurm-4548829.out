device = cuda
  0%|          | 0/10 [00:00<?, ?it/s]  0%|          | 0/10 [02:31<?, ?it/s, Train Loss=0.0064, Validation Loss=0.0029, correlation : =0.8013, cosin correlation : =0.9748, gap : =23.1710] 10%|█         | 1/10 [02:31<22:40, 151.15s/it, Train Loss=0.0064, Validation Loss=0.0029, correlation : =0.8013, cosin correlation : =0.9748, gap : =23.1710] 10%|█         | 1/10 [04:59<22:40, 151.15s/it, Train Loss=0.0025, Validation Loss=0.0022, correlation : =0.8537, cosin correlation : =0.9810, gap : =18.3222] 20%|██        | 2/10 [04:59<19:56, 149.62s/it, Train Loss=0.0025, Validation Loss=0.0022, correlation : =0.8537, cosin correlation : =0.9810, gap : =18.3222] 20%|██        | 2/10 [07:27<19:56, 149.62s/it, Train Loss=0.0021, Validation Loss=0.0020, correlation : =0.8755, cosin correlation : =0.9836, gap : =16.4640] 30%|███       | 3/10 [07:27<17:21, 148.75s/it, Train Loss=0.0021, Validation Loss=0.0020, correlation : =0.8755, cosin correlation : =0.9836, gap : =16.4640] 30%|███       | 3/10 [09:55<17:21, 148.75s/it, Train Loss=0.0019, Validation Loss=0.0019, correlation : =0.8836, cosin correlation : =0.9846, gap : =13.8019] 40%|████      | 4/10 [09:55<14:50, 148.44s/it, Train Loss=0.0019, Validation Loss=0.0019, correlation : =0.8836, cosin correlation : =0.9846, gap : =13.8019] 40%|████      | 4/10 [12:24<14:50, 148.44s/it, Train Loss=0.0018, Validation Loss=0.0019, correlation : =0.8885, cosin correlation : =0.9853, gap : =15.3928] 50%|█████     | 5/10 [12:24<12:23, 148.73s/it, Train Loss=0.0018, Validation Loss=0.0019, correlation : =0.8885, cosin correlation : =0.9853, gap : =15.3928] 50%|█████     | 5/10 [14:52<12:23, 148.73s/it, Train Loss=0.0017, Validation Loss=0.0018, correlation : =0.8940, cosin correlation : =0.9859, gap : =15.0085] 60%|██████    | 6/10 [14:52<09:53, 148.41s/it, Train Loss=0.0017, Validation Loss=0.0018, correlation : =0.8940, cosin correlation : =0.9859, gap : =15.0085] 60%|██████    | 6/10 [17:23<09:53, 148.41s/it, Train Loss=0.0016, Validation Loss=0.0018, correlation : =0.8994, cosin correlation : =0.9865, gap : =16.3717] 70%|███████   | 7/10 [17:23<07:28, 149.43s/it, Train Loss=0.0016, Validation Loss=0.0018, correlation : =0.8994, cosin correlation : =0.9865, gap : =16.3717] 70%|███████   | 7/10 [19:52<07:28, 149.43s/it, Train Loss=0.0015, Validation Loss=0.0019, correlation : =0.9033, cosin correlation : =0.9868, gap : =17.2990] 80%|████████  | 8/10 [19:52<04:58, 149.23s/it, Train Loss=0.0015, Validation Loss=0.0019, correlation : =0.9033, cosin correlation : =0.9868, gap : =17.2990] 80%|████████  | 8/10 [22:21<04:58, 149.23s/it, Train Loss=0.0015, Validation Loss=0.0019, correlation : =0.9069, cosin correlation : =0.9871, gap : =18.0037] 90%|█████████ | 9/10 [22:21<02:29, 149.05s/it, Train Loss=0.0015, Validation Loss=0.0019, correlation : =0.9069, cosin correlation : =0.9871, gap : =18.0037] 90%|█████████ | 9/10 [24:49<02:29, 149.05s/it, Train Loss=0.0014, Validation Loss=0.0018, correlation : =0.9107, cosin correlation : =0.9875, gap : =16.2040]100%|██████████| 10/10 [24:49<00:00, 148.73s/it, Train Loss=0.0014, Validation Loss=0.0018, correlation : =0.9107, cosin correlation : =0.9875, gap : =16.2040]100%|██████████| 10/10 [24:49<00:00, 148.94s/it, Train Loss=0.0014, Validation Loss=0.0018, correlation : =0.9107, cosin correlation : =0.9875, gap : =16.2040]
best args :  Namespace(data_dir=PosixPath('../atsp_n5900'), tb_dir=PosixPath('../model_result_n5900'), embed_dim=64, embed_dim2=128, n_layers=4, n_heads=16, lr_init=0.001, lr_decay=0.9, min_delta=0.0001, patience=5, batch_size=15, n_epochs=10, checkpoint_freq=1, target='regret', use_gpu=True, embd_dim2=128, kj='cat')
