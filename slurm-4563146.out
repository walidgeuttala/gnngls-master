device = cuda
  0%|          | 0/10 [00:00<?, ?it/s]  0%|          | 0/10 [04:04<?, ?it/s, Train Loss=0.0077, Validation Loss=0.0043, correlation : =0.7000, cosin correlation : =0.9641, gap : =27.0323] 10%|█         | 1/10 [04:04<36:39, 244.40s/it, Train Loss=0.0077, Validation Loss=0.0043, correlation : =0.7000, cosin correlation : =0.9641, gap : =27.0323] 10%|█         | 1/10 [08:09<36:39, 244.40s/it, Train Loss=0.0041, Validation Loss=0.0043, correlation : =0.7029, cosin correlation : =0.9644, gap : =27.3256] 20%|██        | 2/10 [08:09<32:39, 244.94s/it, Train Loss=0.0041, Validation Loss=0.0043, correlation : =0.7029, cosin correlation : =0.9644, gap : =27.3256] 20%|██        | 2/10 [12:13<32:39, 244.94s/it, Train Loss=0.0040, Validation Loss=0.0041, correlation : =0.7034, cosin correlation : =0.9646, gap : =25.1593] 30%|███       | 3/10 [12:14<28:32, 244.69s/it, Train Loss=0.0040, Validation Loss=0.0041, correlation : =0.7034, cosin correlation : =0.9646, gap : =25.1593] 30%|███       | 3/10 [16:27<28:32, 244.69s/it, Train Loss=0.0040, Validation Loss=0.0040, correlation : =0.7057, cosin correlation : =0.9649, gap : =27.3285] 40%|████      | 4/10 [16:27<24:49, 248.17s/it, Train Loss=0.0040, Validation Loss=0.0040, correlation : =0.7057, cosin correlation : =0.9649, gap : =27.3285] 40%|████      | 4/10 [20:34<24:49, 248.17s/it, Train Loss=0.0039, Validation Loss=0.0052, correlation : =0.6634, cosin correlation : =0.9600, gap : =30.7870] 50%|█████     | 5/10 [20:35<20:39, 247.91s/it, Train Loss=0.0039, Validation Loss=0.0052, correlation : =0.6634, cosin correlation : =0.9600, gap : =30.7870] 50%|█████     | 5/10 [24:44<20:39, 247.91s/it, Train Loss=0.0035, Validation Loss=0.0159, correlation : =0.6603, cosin correlation : =0.9367, gap : =48.6713] 60%|██████    | 6/10 [24:44<16:34, 248.50s/it, Train Loss=0.0035, Validation Loss=0.0159, correlation : =0.6603, cosin correlation : =0.9367, gap : =48.6713] 60%|██████    | 6/10 [28:50<16:34, 248.50s/it, Train Loss=0.0027, Validation Loss=0.0037, correlation : =0.7979, cosin correlation : =0.9698, gap : =28.9325] 70%|███████   | 7/10 [28:50<12:22, 247.51s/it, Train Loss=0.0027, Validation Loss=0.0037, correlation : =0.7979, cosin correlation : =0.9698, gap : =28.9325] 70%|███████   | 7/10 [32:55<12:22, 247.51s/it, Train Loss=0.0025, Validation Loss=0.0030, correlation : =0.8264, cosin correlation : =0.9774, gap : =22.9131] 80%|████████  | 8/10 [32:55<08:13, 246.80s/it, Train Loss=0.0025, Validation Loss=0.0030, correlation : =0.8264, cosin correlation : =0.9774, gap : =22.9131] 80%|████████  | 8/10 [37:01<08:13, 246.80s/it, Train Loss=0.0024, Validation Loss=0.0025, correlation : =0.8432, cosin correlation : =0.9797, gap : =17.3843] 90%|█████████ | 9/10 [37:01<04:06, 246.70s/it, Train Loss=0.0024, Validation Loss=0.0025, correlation : =0.8432, cosin correlation : =0.9797, gap : =17.3843] 90%|█████████ | 9/10 [41:08<04:06, 246.70s/it, Train Loss=0.0023, Validation Loss=0.0023, correlation : =0.8487, cosin correlation : =0.9806, gap : =17.4502]100%|██████████| 10/10 [41:08<00:00, 246.57s/it, Train Loss=0.0023, Validation Loss=0.0023, correlation : =0.8487, cosin correlation : =0.9806, gap : =17.4502]100%|██████████| 10/10 [41:08<00:00, 246.82s/it, Train Loss=0.0023, Validation Loss=0.0023, correlation : =0.8487, cosin correlation : =0.9806, gap : =17.4502]
best args :  Namespace(data_dir=PosixPath('../tsp_n5900'), tb_dir=PosixPath('../model_result_n5900'), embed_dim=128, embed_dim2=128, n_layers=4, n_heads=16, lr_init=0.001, lr_decay=0.9, min_delta=0.0001, patience=5, batch_size=15, n_epochs=10, checkpoint_freq=1, target='regret', use_gpu=True, embd_dim2=128, kj='cat')
