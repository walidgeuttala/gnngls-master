device = cuda
  0%|          | 0/10 [00:00<?, ?it/s]  0%|          | 0/10 [01:07<?, ?it/s, Train Loss=0.0058, Validation Loss=0.0134, correlation : =0.5800, cosin correlation : =0.9472, gap : =252.9193] 10%|█         | 1/10 [01:07<10:07, 67.46s/it, Train Loss=0.0058, Validation Loss=0.0134, correlation : =0.5800, cosin correlation : =0.9472, gap : =252.9193] 10%|█         | 1/10 [02:11<10:07, 67.46s/it, Train Loss=0.0039, Validation Loss=0.0077, correlation : =0.6802, cosin correlation : =0.9617, gap : =235.4924] 20%|██        | 2/10 [02:11<08:45, 65.74s/it, Train Loss=0.0039, Validation Loss=0.0077, correlation : =0.6802, cosin correlation : =0.9617, gap : =235.4924] 20%|██        | 2/10 [03:18<08:45, 65.74s/it, Train Loss=0.0038, Validation Loss=0.0066, correlation : =0.6881, cosin correlation : =0.9627, gap : =238.2680] 30%|███       | 3/10 [03:18<07:41, 65.97s/it, Train Loss=0.0038, Validation Loss=0.0066, correlation : =0.6881, cosin correlation : =0.9627, gap : =238.2680] 30%|███       | 3/10 [04:23<07:41, 65.97s/it, Train Loss=0.0037, Validation Loss=0.0045, correlation : =0.7184, cosin correlation : =0.9657, gap : =230.0483] 40%|████      | 4/10 [04:23<06:34, 65.77s/it, Train Loss=0.0037, Validation Loss=0.0045, correlation : =0.7184, cosin correlation : =0.9657, gap : =230.0483] 40%|████      | 4/10 [05:28<06:34, 65.77s/it, Train Loss=0.0036, Validation Loss=0.0048, correlation : =0.7278, cosin correlation : =0.9668, gap : =230.6329] 50%|█████     | 5/10 [05:28<05:26, 65.27s/it, Train Loss=0.0036, Validation Loss=0.0048, correlation : =0.7278, cosin correlation : =0.9668, gap : =230.6329] 50%|█████     | 5/10 [06:32<05:26, 65.27s/it, Train Loss=0.0036, Validation Loss=0.0051, correlation : =0.7289, cosin correlation : =0.9667, gap : =229.4405] 60%|██████    | 6/10 [06:32<04:20, 65.11s/it, Train Loss=0.0036, Validation Loss=0.0051, correlation : =0.7289, cosin correlation : =0.9667, gap : =229.4405] 60%|██████    | 6/10 [07:37<04:20, 65.11s/it, Train Loss=0.0035, Validation Loss=0.0054, correlation : =0.7062, cosin correlation : =0.9645, gap : =228.4453] 70%|███████   | 7/10 [07:37<03:14, 64.84s/it, Train Loss=0.0035, Validation Loss=0.0054, correlation : =0.7062, cosin correlation : =0.9645, gap : =228.4453] 70%|███████   | 7/10 [08:42<03:14, 64.84s/it, Train Loss=0.0035, Validation Loss=0.0064, correlation : =0.7303, cosin correlation : =0.9664, gap : =232.9209] 80%|████████  | 8/10 [08:42<02:10, 65.04s/it, Train Loss=0.0035, Validation Loss=0.0064, correlation : =0.7303, cosin correlation : =0.9664, gap : =232.9209] 80%|████████  | 8/10 [09:47<02:10, 65.04s/it, Train Loss=0.0035, Validation Loss=0.0068, correlation : =0.7357, cosin correlation : =0.9665, gap : =230.6822] 80%|████████  | 8/10 [09:47<02:26, 73.38s/it, Train Loss=0.0035, Validation Loss=0.0068, correlation : =0.7357, cosin correlation : =0.9665, gap : =230.6822]
best args :  Namespace(data_dir=PosixPath('../atsp_n5900'), tb_dir=PosixPath('../model_result_n5900'), embed_dim=128, embed_dim2=128, n_layers=4, n_heads=16, lr_init=0.001, lr_decay=0.9, min_delta=0.0001, patience=5, batch_size=15, n_epochs=10, checkpoint_freq=1, target='regret', use_gpu=True, embd_dim2=128, kj='cat')
