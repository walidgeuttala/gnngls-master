device = cuda
  0%|          | 0/10 [00:00<?, ?it/s]  0%|          | 0/10 [04:03<?, ?it/s, Train Loss=0.0077, Validation Loss=0.0043, correlation : =0.7000, cosin correlation : =0.9641, gap : =27.0323] 10%|█         | 1/10 [04:03<36:28, 243.12s/it, Train Loss=0.0077, Validation Loss=0.0043, correlation : =0.7000, cosin correlation : =0.9641, gap : =27.0323] 10%|█         | 1/10 [08:03<36:28, 243.12s/it, Train Loss=0.0041, Validation Loss=0.0043, correlation : =0.7029, cosin correlation : =0.9644, gap : =27.3256] 20%|██        | 2/10 [08:03<32:12, 241.56s/it, Train Loss=0.0041, Validation Loss=0.0043, correlation : =0.7029, cosin correlation : =0.9644, gap : =27.3256] 20%|██        | 2/10 [12:05<32:12, 241.56s/it, Train Loss=0.0040, Validation Loss=0.0041, correlation : =0.7034, cosin correlation : =0.9646, gap : =25.1593] 30%|███       | 3/10 [12:05<28:11, 241.66s/it, Train Loss=0.0040, Validation Loss=0.0041, correlation : =0.7034, cosin correlation : =0.9646, gap : =25.1593] 30%|███       | 3/10 [16:06<28:11, 241.66s/it, Train Loss=0.0040, Validation Loss=0.0040, correlation : =0.7057, cosin correlation : =0.9649, gap : =27.3285] 40%|████      | 4/10 [16:06<24:09, 241.61s/it, Train Loss=0.0040, Validation Loss=0.0040, correlation : =0.7057, cosin correlation : =0.9649, gap : =27.3285] 40%|████      | 4/10 [20:08<24:09, 241.61s/it, Train Loss=0.0039, Validation Loss=0.0052, correlation : =0.6634, cosin correlation : =0.9600, gap : =30.7870] 50%|█████     | 5/10 [20:08<20:08, 241.64s/it, Train Loss=0.0039, Validation Loss=0.0052, correlation : =0.6634, cosin correlation : =0.9600, gap : =30.7870] 50%|█████     | 5/10 [24:10<20:08, 241.64s/it, Train Loss=0.0035, Validation Loss=0.0159, correlation : =0.6603, cosin correlation : =0.9367, gap : =48.6713] 60%|██████    | 6/10 [24:10<16:06, 241.60s/it, Train Loss=0.0035, Validation Loss=0.0159, correlation : =0.6603, cosin correlation : =0.9367, gap : =48.6713] 60%|██████    | 6/10 [28:12<16:06, 241.60s/it, Train Loss=0.0027, Validation Loss=0.0037, correlation : =0.7979, cosin correlation : =0.9698, gap : =28.9325] 70%|███████   | 7/10 [28:12<12:05, 241.87s/it, Train Loss=0.0027, Validation Loss=0.0037, correlation : =0.7979, cosin correlation : =0.9698, gap : =28.9325] 70%|███████   | 7/10 [32:13<12:05, 241.87s/it, Train Loss=0.0025, Validation Loss=0.0030, correlation : =0.8264, cosin correlation : =0.9774, gap : =22.9131] 80%|████████  | 8/10 [32:13<08:03, 241.66s/it, Train Loss=0.0025, Validation Loss=0.0030, correlation : =0.8264, cosin correlation : =0.9774, gap : =22.9131] 80%|████████  | 8/10 [36:15<08:03, 241.66s/it, Train Loss=0.0024, Validation Loss=0.0025, correlation : =0.8432, cosin correlation : =0.9797, gap : =17.3843] 90%|█████████ | 9/10 [36:15<04:01, 241.71s/it, Train Loss=0.0024, Validation Loss=0.0025, correlation : =0.8432, cosin correlation : =0.9797, gap : =17.3843] 90%|█████████ | 9/10 [40:17<04:01, 241.71s/it, Train Loss=0.0023, Validation Loss=0.0023, correlation : =0.8487, cosin correlation : =0.9806, gap : =17.4502]100%|██████████| 10/10 [40:17<00:00, 241.83s/it, Train Loss=0.0023, Validation Loss=0.0023, correlation : =0.8487, cosin correlation : =0.9806, gap : =17.4502]100%|██████████| 10/10 [40:17<00:00, 241.77s/it, Train Loss=0.0023, Validation Loss=0.0023, correlation : =0.8487, cosin correlation : =0.9806, gap : =17.4502]
best args :  Namespace(data_dir=PosixPath('../tsp_n5900'), tb_dir=PosixPath('../model_result_n5900'), embed_dim=128, embed_dim2=128, n_layers=4, n_heads=16, lr_init=0.001, lr_decay=0.9, min_delta=0.0001, patience=5, batch_size=15, n_epochs=10, checkpoint_freq=1, target='regret', use_gpu=True, embd_dim2=128, kj='cat')
