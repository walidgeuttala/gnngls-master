device = cuda
  0%|          | 0/10 [00:00<?, ?it/s]  0%|          | 0/10 [01:40<?, ?it/s, Train Loss=0.0064, Validation Loss=0.0033, correlation : =0.8122, cosin correlation : =0.9759, gap : =25.3219] 10%|█         | 1/10 [01:40<15:06, 100.75s/it, Train Loss=0.0064, Validation Loss=0.0033, correlation : =0.8122, cosin correlation : =0.9759, gap : =25.3219] 10%|█         | 1/10 [03:21<15:06, 100.75s/it, Train Loss=0.0025, Validation Loss=0.0026, correlation : =0.8621, cosin correlation : =0.9818, gap : =19.4263] 20%|██        | 2/10 [03:21<13:28, 101.00s/it, Train Loss=0.0025, Validation Loss=0.0026, correlation : =0.8621, cosin correlation : =0.9818, gap : =19.4263] 20%|██        | 2/10 [05:02<13:28, 101.00s/it, Train Loss=0.0020, Validation Loss=0.0029, correlation : =0.8817, cosin correlation : =0.9841, gap : =16.9697] 30%|███       | 3/10 [05:02<11:45, 100.78s/it, Train Loss=0.0020, Validation Loss=0.0029, correlation : =0.8817, cosin correlation : =0.9841, gap : =16.9697] 30%|███       | 3/10 [06:43<11:45, 100.78s/it, Train Loss=0.0017, Validation Loss=0.0025, correlation : =0.9092, cosin correlation : =0.9877, gap : =16.8727] 40%|████      | 4/10 [06:43<10:04, 100.79s/it, Train Loss=0.0017, Validation Loss=0.0025, correlation : =0.9092, cosin correlation : =0.9877, gap : =16.8727] 40%|████      | 4/10 [08:24<10:04, 100.79s/it, Train Loss=0.0015, Validation Loss=0.0024, correlation : =0.9138, cosin correlation : =0.9882, gap : =17.2716] 50%|█████     | 5/10 [08:24<08:25, 101.02s/it, Train Loss=0.0015, Validation Loss=0.0024, correlation : =0.9138, cosin correlation : =0.9882, gap : =17.2716] 50%|█████     | 5/10 [10:05<08:25, 101.02s/it, Train Loss=0.0014, Validation Loss=0.0023, correlation : =0.9148, cosin correlation : =0.9882, gap : =16.4978] 60%|██████    | 6/10 [10:05<06:43, 100.85s/it, Train Loss=0.0014, Validation Loss=0.0023, correlation : =0.9148, cosin correlation : =0.9882, gap : =16.4978] 60%|██████    | 6/10 [11:46<06:43, 100.85s/it, Train Loss=0.0013, Validation Loss=0.0022, correlation : =0.9160, cosin correlation : =0.9883, gap : =15.6251] 70%|███████   | 7/10 [11:46<05:03, 101.02s/it, Train Loss=0.0013, Validation Loss=0.0022, correlation : =0.9160, cosin correlation : =0.9883, gap : =15.6251] 70%|███████   | 7/10 [13:28<05:03, 101.02s/it, Train Loss=0.0012, Validation Loss=0.0020, correlation : =0.9193, cosin correlation : =0.9888, gap : =15.6555] 80%|████████  | 8/10 [13:28<03:22, 101.26s/it, Train Loss=0.0012, Validation Loss=0.0020, correlation : =0.9193, cosin correlation : =0.9888, gap : =15.6555] 80%|████████  | 8/10 [15:08<03:22, 101.26s/it, Train Loss=0.0012, Validation Loss=0.0019, correlation : =0.9218, cosin correlation : =0.9892, gap : =14.9221] 90%|█████████ | 9/10 [15:08<01:40, 100.97s/it, Train Loss=0.0012, Validation Loss=0.0019, correlation : =0.9218, cosin correlation : =0.9892, gap : =14.9221] 90%|█████████ | 9/10 [16:49<01:40, 100.97s/it, Train Loss=0.0012, Validation Loss=0.0019, correlation : =0.9232, cosin correlation : =0.9895, gap : =15.5523]100%|██████████| 10/10 [16:49<00:00, 101.07s/it, Train Loss=0.0012, Validation Loss=0.0019, correlation : =0.9232, cosin correlation : =0.9895, gap : =15.5523]100%|██████████| 10/10 [16:49<00:00, 101.00s/it, Train Loss=0.0012, Validation Loss=0.0019, correlation : =0.9232, cosin correlation : =0.9895, gap : =15.5523]
best args :  Namespace(data_dir=PosixPath('../atsp_n5900'), tb_dir=PosixPath('../model_result_n5900'), embed_dim=128, embed_dim2=128, n_layers=4, n_heads=16, lr_init=0.001, lr_decay=0.9, min_delta=0.0001, patience=5, batch_size=15, n_epochs=10, checkpoint_freq=1, target='regret', use_gpu=True, embd_dim2=128, kj='cat')
