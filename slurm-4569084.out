device = cuda
  0%|          | 0/10 [00:00<?, ?it/s]  0%|          | 0/10 [00:59<?, ?it/s, Train Loss=0.0079, Validation Loss=0.0108, correlation : =0.8635, cosin correlation : =0.9783, gap : =17.6294] 10%|█         | 1/10 [00:59<08:56, 59.59s/it, Train Loss=0.0079, Validation Loss=0.0108, correlation : =0.8635, cosin correlation : =0.9783, gap : =17.6294] 10%|█         | 1/10 [01:56<08:56, 59.59s/it, Train Loss=0.0021, Validation Loss=0.0066, correlation : =0.8729, cosin correlation : =0.9822, gap : =17.7423] 20%|██        | 2/10 [01:56<07:45, 58.21s/it, Train Loss=0.0021, Validation Loss=0.0066, correlation : =0.8729, cosin correlation : =0.9822, gap : =17.7423] 20%|██        | 2/10 [02:50<07:45, 58.21s/it, Train Loss=0.0019, Validation Loss=0.0065, correlation : =0.8774, cosin correlation : =0.9818, gap : =17.1067] 30%|███       | 3/10 [02:50<06:34, 56.34s/it, Train Loss=0.0019, Validation Loss=0.0065, correlation : =0.8774, cosin correlation : =0.9818, gap : =17.1067] 30%|███       | 3/10 [03:46<06:34, 56.34s/it, Train Loss=0.0018, Validation Loss=0.0079, correlation : =0.8816, cosin correlation : =0.9803, gap : =19.3641] 40%|████      | 4/10 [03:46<05:36, 56.00s/it, Train Loss=0.0018, Validation Loss=0.0079, correlation : =0.8816, cosin correlation : =0.9803, gap : =19.3641] 40%|████      | 4/10 [04:41<05:36, 56.00s/it, Train Loss=0.0017, Validation Loss=0.0071, correlation : =0.8890, cosin correlation : =0.9795, gap : =21.4260] 50%|█████     | 5/10 [04:41<04:38, 55.62s/it, Train Loss=0.0017, Validation Loss=0.0071, correlation : =0.8890, cosin correlation : =0.9795, gap : =21.4260] 50%|█████     | 5/10 [05:37<04:38, 55.62s/it, Train Loss=0.0017, Validation Loss=0.0028, correlation : =0.9028, cosin correlation : =0.9864, gap : =14.7030] 60%|██████    | 6/10 [05:37<03:42, 55.66s/it, Train Loss=0.0017, Validation Loss=0.0028, correlation : =0.9028, cosin correlation : =0.9864, gap : =14.7030] 60%|██████    | 6/10 [06:35<03:42, 55.66s/it, Train Loss=0.0016, Validation Loss=0.0015, correlation : =0.9067, cosin correlation : =0.9877, gap : =15.0886] 70%|███████   | 7/10 [06:35<02:50, 56.67s/it, Train Loss=0.0016, Validation Loss=0.0015, correlation : =0.9067, cosin correlation : =0.9877, gap : =15.0886] 70%|███████   | 7/10 [07:34<02:50, 56.67s/it, Train Loss=0.0016, Validation Loss=0.0015, correlation : =0.9090, cosin correlation : =0.9880, gap : =13.8308] 80%|████████  | 8/10 [07:34<01:54, 57.17s/it, Train Loss=0.0016, Validation Loss=0.0015, correlation : =0.9090, cosin correlation : =0.9880, gap : =13.8308] 80%|████████  | 8/10 [08:29<01:54, 57.17s/it, Train Loss=0.0015, Validation Loss=0.0015, correlation : =0.9113, cosin correlation : =0.9882, gap : =11.8718] 90%|█████████ | 9/10 [08:29<00:56, 56.71s/it, Train Loss=0.0015, Validation Loss=0.0015, correlation : =0.9113, cosin correlation : =0.9882, gap : =11.8718] 90%|█████████ | 9/10 [09:25<00:56, 56.71s/it, Train Loss=0.0015, Validation Loss=0.0016, correlation : =0.9140, cosin correlation : =0.9885, gap : =12.9273]100%|██████████| 10/10 [09:25<00:00, 56.31s/it, Train Loss=0.0015, Validation Loss=0.0016, correlation : =0.9140, cosin correlation : =0.9885, gap : =12.9273]100%|██████████| 10/10 [09:25<00:00, 56.52s/it, Train Loss=0.0015, Validation Loss=0.0016, correlation : =0.9140, cosin correlation : =0.9885, gap : =12.9273]
best args :  Namespace(data_dir=PosixPath('../tsp_n5900'), tb_dir=PosixPath('../model_result_n5900'), embed_dim=128, embed_dim2=128, n_layers=4, n_heads=16, lr_init=0.001, lr_decay=0.9, min_delta=0.0001, patience=5, batch_size=15, n_epochs=10, checkpoint_freq=1, target='regret', use_gpu=True, embd_dim2=128, kj='cat')
