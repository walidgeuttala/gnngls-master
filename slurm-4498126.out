device = cuda
  0%|          | 0/10 [00:00<?, ?it/s]  0%|          | 0/10 [01:34<?, ?it/s, Train Loss=0.0366, Validation Loss=0.0026, correlation : =0.8358, cosin correlation : =0.9783, gap : =17.3973] 10%|█         | 1/10 [01:35<14:15, 95.02s/it, Train Loss=0.0366, Validation Loss=0.0026, correlation : =0.8358, cosin correlation : =0.9783, gap : =17.3973] 10%|█         | 1/10 [03:02<14:15, 95.02s/it, Train Loss=0.0023, Validation Loss=0.0022, correlation : =0.8539, cosin correlation : =0.9810, gap : =17.2739] 20%|██        | 2/10 [03:02<12:03, 90.47s/it, Train Loss=0.0023, Validation Loss=0.0022, correlation : =0.8539, cosin correlation : =0.9810, gap : =17.2739] 20%|██        | 2/10 [04:28<12:03, 90.47s/it, Train Loss=0.0020, Validation Loss=0.0027, correlation : =0.8694, cosin correlation : =0.9805, gap : =19.6494] 30%|███       | 3/10 [04:28<10:20, 88.68s/it, Train Loss=0.0020, Validation Loss=0.0027, correlation : =0.8694, cosin correlation : =0.9805, gap : =19.6494] 30%|███       | 3/10 [05:56<10:20, 88.68s/it, Train Loss=0.0018, Validation Loss=0.0025, correlation : =0.8882, cosin correlation : =0.9852, gap : =13.6563] 40%|████      | 4/10 [05:56<08:48, 88.10s/it, Train Loss=0.0018, Validation Loss=0.0025, correlation : =0.8882, cosin correlation : =0.9852, gap : =13.6563] 40%|████      | 4/10 [07:22<08:48, 88.10s/it, Train Loss=0.0017, Validation Loss=0.0020, correlation : =0.8828, cosin correlation : =0.9845, gap : =15.6239] 50%|█████     | 5/10 [07:23<07:18, 87.68s/it, Train Loss=0.0017, Validation Loss=0.0020, correlation : =0.8828, cosin correlation : =0.9845, gap : =15.6239] 50%|█████     | 5/10 [08:49<07:18, 87.68s/it, Train Loss=0.0016, Validation Loss=0.0017, correlation : =0.9030, cosin correlation : =0.9869, gap : =16.5673] 60%|██████    | 6/10 [08:50<05:49, 87.45s/it, Train Loss=0.0016, Validation Loss=0.0017, correlation : =0.9030, cosin correlation : =0.9869, gap : =16.5673] 60%|██████    | 6/10 [10:19<05:49, 87.45s/it, Train Loss=0.0015, Validation Loss=0.0017, correlation : =0.9037, cosin correlation : =0.9871, gap : =14.8450] 70%|███████   | 7/10 [10:19<04:24, 88.01s/it, Train Loss=0.0015, Validation Loss=0.0017, correlation : =0.9037, cosin correlation : =0.9871, gap : =14.8450] 70%|███████   | 7/10 [11:46<04:24, 88.01s/it, Train Loss=0.0015, Validation Loss=0.0018, correlation : =0.9008, cosin correlation : =0.9864, gap : =16.7544] 80%|████████  | 8/10 [11:46<02:55, 87.77s/it, Train Loss=0.0015, Validation Loss=0.0018, correlation : =0.9008, cosin correlation : =0.9864, gap : =16.7544] 80%|████████  | 8/10 [13:13<02:55, 87.77s/it, Train Loss=0.0015, Validation Loss=0.0018, correlation : =0.9068, cosin correlation : =0.9867, gap : =17.0475] 90%|█████████ | 9/10 [13:13<01:27, 87.64s/it, Train Loss=0.0015, Validation Loss=0.0018, correlation : =0.9068, cosin correlation : =0.9867, gap : =17.0475] 90%|█████████ | 9/10 [14:41<01:27, 87.64s/it, Train Loss=0.0015, Validation Loss=0.0018, correlation : =0.8934, cosin correlation : =0.9848, gap : =18.5615]100%|██████████| 10/10 [14:41<00:00, 87.64s/it, Train Loss=0.0015, Validation Loss=0.0018, correlation : =0.8934, cosin correlation : =0.9848, gap : =18.5615]100%|██████████| 10/10 [14:41<00:00, 88.14s/it, Train Loss=0.0015, Validation Loss=0.0018, correlation : =0.8934, cosin correlation : =0.9848, gap : =18.5615]
device = cuda
  0%|          | 0/10 [00:00<?, ?it/s]  0%|          | 0/10 [01:27<?, ?it/s, Train Loss=0.0366, Validation Loss=0.0026, correlation : =0.8358, cosin correlation : =0.9783, gap : =17.3973] 10%|█         | 1/10 [01:27<13:05, 87.24s/it, Train Loss=0.0366, Validation Loss=0.0026, correlation : =0.8358, cosin correlation : =0.9783, gap : =17.3973] 10%|█         | 1/10 [02:54<13:05, 87.24s/it, Train Loss=0.0023, Validation Loss=0.0022, correlation : =0.8539, cosin correlation : =0.9810, gap : =17.2739] 20%|██        | 2/10 [02:54<11:37, 87.19s/it, Train Loss=0.0023, Validation Loss=0.0022, correlation : =0.8539, cosin correlation : =0.9810, gap : =17.2739] 20%|██        | 2/10 [04:21<11:37, 87.19s/it, Train Loss=0.0020, Validation Loss=0.0027, correlation : =0.8694, cosin correlation : =0.9805, gap : =19.6494] 30%|███       | 3/10 [04:21<10:11, 87.37s/it, Train Loss=0.0020, Validation Loss=0.0027, correlation : =0.8694, cosin correlation : =0.9805, gap : =19.6494] 30%|███       | 3/10 [05:49<10:11, 87.37s/it, Train Loss=0.0018, Validation Loss=0.0025, correlation : =0.8882, cosin correlation : =0.9852, gap : =13.6563] 40%|████      | 4/10 [05:49<08:44, 87.44s/it, Train Loss=0.0018, Validation Loss=0.0025, correlation : =0.8882, cosin correlation : =0.9852, gap : =13.6563] 40%|████      | 4/10 [07:17<08:44, 87.44s/it, Train Loss=0.0017, Validation Loss=0.0020, correlation : =0.8828, cosin correlation : =0.9845, gap : =15.6239] 50%|█████     | 5/10 [07:17<07:17, 87.48s/it, Train Loss=0.0017, Validation Loss=0.0020, correlation : =0.8828, cosin correlation : =0.9845, gap : =15.6239] 50%|█████     | 5/10 [08:45<07:17, 87.48s/it, Train Loss=0.0016, Validation Loss=0.0017, correlation : =0.9030, cosin correlation : =0.9869, gap : =16.5673] 60%|██████    | 6/10 [08:45<05:51, 87.80s/it, Train Loss=0.0016, Validation Loss=0.0017, correlation : =0.9030, cosin correlation : =0.9869, gap : =16.5673] 60%|██████    | 6/10 [10:13<05:51, 87.80s/it, Train Loss=0.0015, Validation Loss=0.0017, correlation : =0.9037, cosin correlation : =0.9871, gap : =14.8450] 70%|███████   | 7/10 [10:13<04:23, 87.80s/it, Train Loss=0.0015, Validation Loss=0.0017, correlation : =0.9037, cosin correlation : =0.9871, gap : =14.8450] 70%|███████   | 7/10 [11:40<04:23, 87.80s/it, Train Loss=0.0015, Validation Loss=0.0018, correlation : =0.9008, cosin correlation : =0.9864, gap : =16.7544] 80%|████████  | 8/10 [11:40<02:55, 87.69s/it, Train Loss=0.0015, Validation Loss=0.0018, correlation : =0.9008, cosin correlation : =0.9864, gap : =16.7544] 80%|████████  | 8/10 [13:08<02:55, 87.69s/it, Train Loss=0.0015, Validation Loss=0.0018, correlation : =0.9068, cosin correlation : =0.9867, gap : =17.0475] 90%|█████████ | 9/10 [13:08<01:27, 87.57s/it, Train Loss=0.0015, Validation Loss=0.0018, correlation : =0.9068, cosin correlation : =0.9867, gap : =17.0475] 90%|█████████ | 9/10 [14:35<01:27, 87.57s/it, Train Loss=0.0015, Validation Loss=0.0018, correlation : =0.8934, cosin correlation : =0.9848, gap : =18.5615]100%|██████████| 10/10 [14:35<00:00, 87.58s/it, Train Loss=0.0015, Validation Loss=0.0018, correlation : =0.8934, cosin correlation : =0.9848, gap : =18.5615]100%|██████████| 10/10 [14:35<00:00, 87.57s/it, Train Loss=0.0015, Validation Loss=0.0018, correlation : =0.8934, cosin correlation : =0.9848, gap : =18.5615]
device = cuda
  0%|          | 0/10 [00:00<?, ?it/s]  0%|          | 0/10 [01:10<?, ?it/s, Train Loss=0.0140, Validation Loss=0.0025, correlation : =0.8603, cosin correlation : =0.9817, gap : =17.6499] 10%|█         | 1/10 [01:10<10:31, 70.14s/it, Train Loss=0.0140, Validation Loss=0.0025, correlation : =0.8603, cosin correlation : =0.9817, gap : =17.6499] 10%|█         | 1/10 [02:20<10:31, 70.14s/it, Train Loss=0.0019, Validation Loss=0.0028, correlation : =0.8764, cosin correlation : =0.9834, gap : =18.2077] 20%|██        | 2/10 [02:20<09:21, 70.19s/it, Train Loss=0.0019, Validation Loss=0.0028, correlation : =0.8764, cosin correlation : =0.9834, gap : =18.2077] 20%|██        | 2/10 [03:30<09:21, 70.19s/it, Train Loss=0.0018, Validation Loss=0.0023, correlation : =0.8867, cosin correlation : =0.9852, gap : =16.1909] 30%|███       | 3/10 [03:30<08:09, 70.00s/it, Train Loss=0.0018, Validation Loss=0.0023, correlation : =0.8867, cosin correlation : =0.9852, gap : =16.1909] 30%|███       | 3/10 [04:39<08:09, 70.00s/it, Train Loss=0.0018, Validation Loss=0.0018, correlation : =0.8859, cosin correlation : =0.9847, gap : =16.4620] 40%|████      | 4/10 [04:39<06:59, 69.89s/it, Train Loss=0.0018, Validation Loss=0.0018, correlation : =0.8859, cosin correlation : =0.9847, gap : =16.4620] 40%|████      | 4/10 [05:51<06:59, 69.89s/it, Train Loss=0.0018, Validation Loss=0.0020, correlation : =0.8872, cosin correlation : =0.9835, gap : =15.9239] 50%|█████     | 5/10 [05:51<05:52, 70.57s/it, Train Loss=0.0018, Validation Loss=0.0020, correlation : =0.8872, cosin correlation : =0.9835, gap : =15.9239] 50%|█████     | 5/10 [07:00<05:52, 70.57s/it, Train Loss=0.0016, Validation Loss=0.0020, correlation : =0.8919, cosin correlation : =0.9853, gap : =13.9724] 60%|██████    | 6/10 [07:00<04:40, 70.14s/it, Train Loss=0.0016, Validation Loss=0.0020, correlation : =0.8919, cosin correlation : =0.9853, gap : =13.9724] 60%|██████    | 6/10 [08:10<04:40, 70.14s/it, Train Loss=0.0015, Validation Loss=0.0016, correlation : =0.9086, cosin correlation : =0.9876, gap : =13.9752] 70%|███████   | 7/10 [08:10<03:30, 70.06s/it, Train Loss=0.0015, Validation Loss=0.0016, correlation : =0.9086, cosin correlation : =0.9876, gap : =13.9752] 70%|███████   | 7/10 [09:20<03:30, 70.06s/it, Train Loss=0.0015, Validation Loss=0.0014, correlation : =0.9124, cosin correlation : =0.9882, gap : =13.7552] 80%|████████  | 8/10 [09:20<02:19, 69.80s/it, Train Loss=0.0015, Validation Loss=0.0014, correlation : =0.9124, cosin correlation : =0.9882, gap : =13.7552] 80%|████████  | 8/10 [10:29<02:19, 69.80s/it, Train Loss=0.0015, Validation Loss=0.0024, correlation : =0.9126, cosin correlation : =0.9883, gap : =12.5684] 90%|█████████ | 9/10 [10:29<01:09, 69.72s/it, Train Loss=0.0015, Validation Loss=0.0024, correlation : =0.9126, cosin correlation : =0.9883, gap : =12.5684] 90%|█████████ | 9/10 [11:39<01:09, 69.72s/it, Train Loss=0.0014, Validation Loss=0.0014, correlation : =0.9106, cosin correlation : =0.9879, gap : =14.4639]100%|██████████| 10/10 [11:39<00:00, 69.74s/it, Train Loss=0.0014, Validation Loss=0.0014, correlation : =0.9106, cosin correlation : =0.9879, gap : =14.4639]100%|██████████| 10/10 [11:39<00:00, 69.94s/it, Train Loss=0.0014, Validation Loss=0.0014, correlation : =0.9106, cosin correlation : =0.9879, gap : =14.4639]
device = cuda
  0%|          | 0/10 [00:00<?, ?it/s]  0%|          | 0/10 [01:10<?, ?it/s, Train Loss=0.0140, Validation Loss=0.0025, correlation : =0.8603, cosin correlation : =0.9817, gap : =17.6499] 10%|█         | 1/10 [01:10<10:30, 70.03s/it, Train Loss=0.0140, Validation Loss=0.0025, correlation : =0.8603, cosin correlation : =0.9817, gap : =17.6499] 10%|█         | 1/10 [02:18<10:30, 70.03s/it, Train Loss=0.0019, Validation Loss=0.0028, correlation : =0.8764, cosin correlation : =0.9834, gap : =18.2077] 20%|██        | 2/10 [02:18<09:14, 69.29s/it, Train Loss=0.0019, Validation Loss=0.0028, correlation : =0.8764, cosin correlation : =0.9834, gap : =18.2077] 20%|██        | 2/10 [03:28<09:14, 69.29s/it, Train Loss=0.0018, Validation Loss=0.0023, correlation : =0.8867, cosin correlation : =0.9852, gap : =16.1909] 30%|███       | 3/10 [03:28<08:06, 69.46s/it, Train Loss=0.0018, Validation Loss=0.0023, correlation : =0.8867, cosin correlation : =0.9852, gap : =16.1909] 30%|███       | 3/10 [04:39<08:06, 69.46s/it, Train Loss=0.0018, Validation Loss=0.0018, correlation : =0.8859, cosin correlation : =0.9847, gap : =16.4620] 40%|████      | 4/10 [04:39<07:00, 70.02s/it, Train Loss=0.0018, Validation Loss=0.0018, correlation : =0.8859, cosin correlation : =0.9847, gap : =16.4620] 40%|████      | 4/10 [05:48<07:00, 70.02s/it, Train Loss=0.0018, Validation Loss=0.0020, correlation : =0.8872, cosin correlation : =0.9835, gap : =15.9239] 50%|█████     | 5/10 [05:48<05:48, 69.78s/it, Train Loss=0.0018, Validation Loss=0.0020, correlation : =0.8872, cosin correlation : =0.9835, gap : =15.9239] 50%|█████     | 5/10 [06:58<05:48, 69.78s/it, Train Loss=0.0016, Validation Loss=0.0020, correlation : =0.8919, cosin correlation : =0.9853, gap : =13.9724] 60%|██████    | 6/10 [06:58<04:39, 69.86s/it, Train Loss=0.0016, Validation Loss=0.0020, correlation : =0.8919, cosin correlation : =0.9853, gap : =13.9724] 60%|██████    | 6/10 [08:08<04:39, 69.86s/it, Train Loss=0.0015, Validation Loss=0.0016, correlation : =0.9086, cosin correlation : =0.9876, gap : =13.9752] 70%|███████   | 7/10 [08:09<03:30, 70.00s/it, Train Loss=0.0015, Validation Loss=0.0016, correlation : =0.9086, cosin correlation : =0.9876, gap : =13.9752] 70%|███████   | 7/10 [09:19<03:30, 70.00s/it, Train Loss=0.0015, Validation Loss=0.0014, correlation : =0.9124, cosin correlation : =0.9882, gap : =13.7552] 80%|████████  | 8/10 [09:19<02:20, 70.04s/it, Train Loss=0.0015, Validation Loss=0.0014, correlation : =0.9124, cosin correlation : =0.9882, gap : =13.7552] 80%|████████  | 8/10 [10:29<02:20, 70.04s/it, Train Loss=0.0015, Validation Loss=0.0024, correlation : =0.9126, cosin correlation : =0.9883, gap : =12.5684] 90%|█████████ | 9/10 [10:29<01:10, 70.12s/it, Train Loss=0.0015, Validation Loss=0.0024, correlation : =0.9126, cosin correlation : =0.9883, gap : =12.5684] 90%|█████████ | 9/10 [11:38<01:10, 70.12s/it, Train Loss=0.0014, Validation Loss=0.0014, correlation : =0.9106, cosin correlation : =0.9879, gap : =14.4639]100%|██████████| 10/10 [11:38<00:00, 69.95s/it, Train Loss=0.0014, Validation Loss=0.0014, correlation : =0.9106, cosin correlation : =0.9879, gap : =14.4639]100%|██████████| 10/10 [11:38<00:00, 69.90s/it, Train Loss=0.0014, Validation Loss=0.0014, correlation : =0.9106, cosin correlation : =0.9879, gap : =14.4639]
best args :  Namespace(data_dir=PosixPath('../tsp_n5900'), tb_dir=PosixPath('../model_result_n5900'), embed_dim=128, embed_dim2=128, n_layers=4, n_heads=32, lr_init=0.001, lr_decay=0.99, min_delta=0.0001, patience=5, batch_size=15, n_epochs=10, checkpoint_freq=1, target='regret', use_gpu=True, embd_dim2=128, kj='cat')
