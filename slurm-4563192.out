device = cuda
  0%|          | 0/10 [00:00<?, ?it/s]  0%|          | 0/10 [01:13<?, ?it/s, Train Loss=0.0135, Validation Loss=0.0025, correlation : =0.8460, cosin correlation : =0.9800, gap : =16.3150] 10%|█         | 1/10 [01:13<10:58, 73.22s/it, Train Loss=0.0135, Validation Loss=0.0025, correlation : =0.8460, cosin correlation : =0.9800, gap : =16.3150] 10%|█         | 1/10 [02:10<10:58, 73.22s/it, Train Loss=0.0018, Validation Loss=0.0020, correlation : =0.8741, cosin correlation : =0.9830, gap : =13.5375] 20%|██        | 2/10 [02:10<08:30, 63.85s/it, Train Loss=0.0018, Validation Loss=0.0020, correlation : =0.8741, cosin correlation : =0.9830, gap : =13.5375] 20%|██        | 2/10 [03:07<08:30, 63.85s/it, Train Loss=0.0017, Validation Loss=0.0018, correlation : =0.8864, cosin correlation : =0.9843, gap : =14.1690] 30%|███       | 3/10 [03:07<07:05, 60.84s/it, Train Loss=0.0017, Validation Loss=0.0018, correlation : =0.8864, cosin correlation : =0.9843, gap : =14.1690] 30%|███       | 3/10 [04:04<07:05, 60.84s/it, Train Loss=0.0016, Validation Loss=0.0020, correlation : =0.8875, cosin correlation : =0.9834, gap : =13.7359] 40%|████      | 4/10 [04:04<05:54, 59.16s/it, Train Loss=0.0016, Validation Loss=0.0020, correlation : =0.8875, cosin correlation : =0.9834, gap : =13.7359] 40%|████      | 4/10 [05:01<05:54, 59.16s/it, Train Loss=0.0015, Validation Loss=0.0020, correlation : =0.8913, cosin correlation : =0.9837, gap : =14.4641] 50%|█████     | 5/10 [05:01<04:52, 58.48s/it, Train Loss=0.0015, Validation Loss=0.0020, correlation : =0.8913, cosin correlation : =0.9837, gap : =14.4641] 50%|█████     | 5/10 [05:59<04:52, 58.48s/it, Train Loss=0.0015, Validation Loss=0.0018, correlation : =0.8964, cosin correlation : =0.9850, gap : =15.5170] 60%|██████    | 6/10 [05:59<03:53, 58.37s/it, Train Loss=0.0015, Validation Loss=0.0018, correlation : =0.8964, cosin correlation : =0.9850, gap : =15.5170] 60%|██████    | 6/10 [06:58<03:53, 58.37s/it, Train Loss=0.0014, Validation Loss=0.0017, correlation : =0.9012, cosin correlation : =0.9859, gap : =14.7008] 70%|███████   | 7/10 [06:58<02:55, 58.63s/it, Train Loss=0.0014, Validation Loss=0.0017, correlation : =0.9012, cosin correlation : =0.9859, gap : =14.7008] 70%|███████   | 7/10 [07:57<02:55, 58.63s/it, Train Loss=0.0014, Validation Loss=0.0017, correlation : =0.9046, cosin correlation : =0.9865, gap : =12.0687] 80%|████████  | 8/10 [07:57<01:57, 58.55s/it, Train Loss=0.0014, Validation Loss=0.0017, correlation : =0.9046, cosin correlation : =0.9865, gap : =12.0687] 80%|████████  | 8/10 [08:55<01:57, 58.55s/it, Train Loss=0.0014, Validation Loss=0.0016, correlation : =0.9086, cosin correlation : =0.9873, gap : =12.6868] 90%|█████████ | 9/10 [08:55<00:58, 58.38s/it, Train Loss=0.0014, Validation Loss=0.0016, correlation : =0.9086, cosin correlation : =0.9873, gap : =12.6868] 90%|█████████ | 9/10 [09:53<00:58, 58.38s/it, Train Loss=0.0014, Validation Loss=0.0016, correlation : =0.9097, cosin correlation : =0.9873, gap : =12.5254]100%|██████████| 10/10 [09:53<00:00, 58.34s/it, Train Loss=0.0014, Validation Loss=0.0016, correlation : =0.9097, cosin correlation : =0.9873, gap : =12.5254]100%|██████████| 10/10 [09:53<00:00, 59.36s/it, Train Loss=0.0014, Validation Loss=0.0016, correlation : =0.9097, cosin correlation : =0.9873, gap : =12.5254]
best args :  Namespace(data_dir=PosixPath('../tsp_n5900'), tb_dir=PosixPath('../model_result_n5900'), embed_dim=128, embed_dim2=128, n_layers=4, n_heads=16, lr_init=0.001, lr_decay=0.9, min_delta=0.0001, patience=5, batch_size=15, n_epochs=10, checkpoint_freq=1, target='regret', use_gpu=True, embd_dim2=128, kj='cat')
