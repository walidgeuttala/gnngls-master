device = cuda
  0%|          | 0/10 [00:00<?, ?it/s]  0%|          | 0/10 [01:21<?, ?it/s, Train Loss=0.0059, Validation Loss=0.0262, correlation : =0.6525, cosin correlation : =0.9082, gap : =286.5510] 10%|█         | 1/10 [01:22<12:19, 82.12s/it, Train Loss=0.0059, Validation Loss=0.0262, correlation : =0.6525, cosin correlation : =0.9082, gap : =286.5510] 10%|█         | 1/10 [02:25<12:19, 82.12s/it, Train Loss=0.0043, Validation Loss=0.0215, correlation : =0.6737, cosin correlation : =0.9117, gap : =283.3719] 20%|██        | 2/10 [02:25<09:27, 70.94s/it, Train Loss=0.0043, Validation Loss=0.0215, correlation : =0.6737, cosin correlation : =0.9117, gap : =283.3719] 20%|██        | 2/10 [03:22<09:27, 70.94s/it, Train Loss=0.0042, Validation Loss=0.0131, correlation : =0.6763, cosin correlation : =0.9545, gap : =235.3150] 30%|███       | 3/10 [03:23<07:35, 65.08s/it, Train Loss=0.0042, Validation Loss=0.0131, correlation : =0.6763, cosin correlation : =0.9545, gap : =235.3150] 30%|███       | 3/10 [04:12<07:35, 65.08s/it, Train Loss=0.0042, Validation Loss=0.0109, correlation : =0.6752, cosin correlation : =0.9565, gap : =236.6522] 40%|████      | 4/10 [04:12<05:53, 58.89s/it, Train Loss=0.0042, Validation Loss=0.0109, correlation : =0.6752, cosin correlation : =0.9565, gap : =236.6522] 40%|████      | 4/10 [05:02<05:53, 58.89s/it, Train Loss=0.0041, Validation Loss=0.0083, correlation : =0.6742, cosin correlation : =0.9603, gap : =230.2448] 50%|█████     | 5/10 [05:03<04:39, 55.89s/it, Train Loss=0.0041, Validation Loss=0.0083, correlation : =0.6742, cosin correlation : =0.9603, gap : =230.2448] 50%|█████     | 5/10 [05:55<04:39, 55.89s/it, Train Loss=0.0041, Validation Loss=0.0067, correlation : =0.6839, cosin correlation : =0.9618, gap : =227.4228] 60%|██████    | 6/10 [05:55<03:38, 54.58s/it, Train Loss=0.0041, Validation Loss=0.0067, correlation : =0.6839, cosin correlation : =0.9618, gap : =227.4228] 60%|██████    | 6/10 [06:50<03:38, 54.58s/it, Train Loss=0.0041, Validation Loss=0.0058, correlation : =0.6906, cosin correlation : =0.9625, gap : =227.2633] 70%|███████   | 7/10 [06:50<02:44, 54.73s/it, Train Loss=0.0041, Validation Loss=0.0058, correlation : =0.6906, cosin correlation : =0.9625, gap : =227.2633] 70%|███████   | 7/10 [07:37<02:44, 54.73s/it, Train Loss=0.0041, Validation Loss=0.0053, correlation : =0.6915, cosin correlation : =0.9627, gap : =228.5939] 80%|████████  | 8/10 [07:37<01:44, 52.29s/it, Train Loss=0.0041, Validation Loss=0.0053, correlation : =0.6915, cosin correlation : =0.9627, gap : =228.5939] 80%|████████  | 8/10 [08:31<01:44, 52.29s/it, Train Loss=0.0041, Validation Loss=0.0053, correlation : =0.6922, cosin correlation : =0.9628, gap : =229.4692] 90%|█████████ | 9/10 [08:31<00:52, 52.86s/it, Train Loss=0.0041, Validation Loss=0.0053, correlation : =0.6922, cosin correlation : =0.9628, gap : =229.4692] 90%|█████████ | 9/10 [09:25<00:52, 52.86s/it, Train Loss=0.0041, Validation Loss=0.0050, correlation : =0.6928, cosin correlation : =0.9632, gap : =232.2166]100%|██████████| 10/10 [09:25<00:00, 53.18s/it, Train Loss=0.0041, Validation Loss=0.0050, correlation : =0.6928, cosin correlation : =0.9632, gap : =232.2166]100%|██████████| 10/10 [09:25<00:00, 56.55s/it, Train Loss=0.0041, Validation Loss=0.0050, correlation : =0.6928, cosin correlation : =0.9632, gap : =232.2166]
best args :  Namespace(data_dir=PosixPath('../atsp_n5900'), tb_dir=PosixPath('../model_result_n5900'), embed_dim=128, embed_dim2=128, n_layers=4, n_heads=16, lr_init=0.001, lr_decay=0.9, min_delta=0.0001, patience=5, batch_size=15, n_epochs=10, checkpoint_freq=1, target='regret', use_gpu=True, embd_dim2=128, kj='cat')
