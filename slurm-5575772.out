device = cuda
  0%|          | 0/10 [00:00<?, ?it/s]  0%|          | 0/10 [00:56<?, ?it/s, Train Loss=0.0059, Validation Loss=0.0240, correlation : =0.6444, cosin correlation : =0.9243, gap : =272.1973] 10%|█         | 1/10 [00:56<08:25, 56.16s/it, Train Loss=0.0059, Validation Loss=0.0240, correlation : =0.6444, cosin correlation : =0.9243, gap : =272.1973] 10%|█         | 1/10 [01:48<08:25, 56.16s/it, Train Loss=0.0042, Validation Loss=0.0181, correlation : =0.6718, cosin correlation : =0.9362, gap : =254.6776] 20%|██        | 2/10 [01:48<07:09, 53.68s/it, Train Loss=0.0042, Validation Loss=0.0181, correlation : =0.6718, cosin correlation : =0.9362, gap : =254.6776] 20%|██        | 2/10 [02:39<07:09, 53.68s/it, Train Loss=0.0042, Validation Loss=0.0144, correlation : =0.6717, cosin correlation : =0.9529, gap : =244.0922] 30%|███       | 3/10 [02:39<06:09, 52.72s/it, Train Loss=0.0042, Validation Loss=0.0144, correlation : =0.6717, cosin correlation : =0.9529, gap : =244.0922] 30%|███       | 3/10 [03:31<06:09, 52.72s/it, Train Loss=0.0042, Validation Loss=0.0111, correlation : =0.6845, cosin correlation : =0.9552, gap : =241.4941] 40%|████      | 4/10 [03:31<05:13, 52.31s/it, Train Loss=0.0042, Validation Loss=0.0111, correlation : =0.6845, cosin correlation : =0.9552, gap : =241.4941] 40%|████      | 4/10 [04:22<05:13, 52.31s/it, Train Loss=0.0041, Validation Loss=0.0088, correlation : =0.6812, cosin correlation : =0.9600, gap : =234.4127] 50%|█████     | 5/10 [04:22<04:20, 52.02s/it, Train Loss=0.0041, Validation Loss=0.0088, correlation : =0.6812, cosin correlation : =0.9600, gap : =234.4127] 50%|█████     | 5/10 [05:13<04:20, 52.02s/it, Train Loss=0.0041, Validation Loss=0.0061, correlation : =0.6891, cosin correlation : =0.9624, gap : =230.7950] 60%|██████    | 6/10 [05:14<03:26, 51.73s/it, Train Loss=0.0041, Validation Loss=0.0061, correlation : =0.6891, cosin correlation : =0.9624, gap : =230.7950] 60%|██████    | 6/10 [06:05<03:26, 51.73s/it, Train Loss=0.0041, Validation Loss=0.0053, correlation : =0.6927, cosin correlation : =0.9629, gap : =229.3149] 70%|███████   | 7/10 [06:05<02:34, 51.54s/it, Train Loss=0.0041, Validation Loss=0.0053, correlation : =0.6927, cosin correlation : =0.9629, gap : =229.3149] 70%|███████   | 7/10 [06:56<02:34, 51.54s/it, Train Loss=0.0041, Validation Loss=0.0053, correlation : =0.6931, cosin correlation : =0.9631, gap : =230.4946] 80%|████████  | 8/10 [06:56<01:42, 51.36s/it, Train Loss=0.0041, Validation Loss=0.0053, correlation : =0.6931, cosin correlation : =0.9631, gap : =230.4946] 80%|████████  | 8/10 [07:47<01:42, 51.36s/it, Train Loss=0.0041, Validation Loss=0.0053, correlation : =0.6937, cosin correlation : =0.9630, gap : =226.2472] 90%|█████████ | 9/10 [07:47<00:51, 51.26s/it, Train Loss=0.0041, Validation Loss=0.0053, correlation : =0.6937, cosin correlation : =0.9630, gap : =226.2472] 90%|█████████ | 9/10 [08:38<00:51, 51.26s/it, Train Loss=0.0040, Validation Loss=0.0048, correlation : =0.6943, cosin correlation : =0.9633, gap : =232.7724]100%|██████████| 10/10 [08:38<00:00, 51.19s/it, Train Loss=0.0040, Validation Loss=0.0048, correlation : =0.6943, cosin correlation : =0.9633, gap : =232.7724]100%|██████████| 10/10 [08:38<00:00, 51.82s/it, Train Loss=0.0040, Validation Loss=0.0048, correlation : =0.6943, cosin correlation : =0.9633, gap : =232.7724]
best args :  Namespace(data_dir=PosixPath('../atsp_n5900'), tb_dir=PosixPath('../model_result_n5900'), embed_dim=128, embed_dim2=128, n_layers=4, n_heads=16, lr_init=0.001, lr_decay=0.9, min_delta=0.0001, patience=5, batch_size=15, n_epochs=10, checkpoint_freq=1, target='regret', use_gpu=True, embd_dim2=256, kj='cat')
