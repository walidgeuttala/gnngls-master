device = cuda
  0%|          | 0/10 [00:00<?, ?it/s]  0%|          | 0/10 [01:02<?, ?it/s, Train Loss=0.0114, Validation Loss=0.0045, correlation : =0.7048, cosin correlation : =0.9649, gap : =28.7549] 10%|█         | 1/10 [01:02<09:26, 62.91s/it, Train Loss=0.0114, Validation Loss=0.0045, correlation : =0.7048, cosin correlation : =0.9649, gap : =28.7549] 10%|█         | 1/10 [01:59<09:26, 62.91s/it, Train Loss=0.0041, Validation Loss=0.0044, correlation : =0.7042, cosin correlation : =0.9645, gap : =29.6052] 20%|██        | 2/10 [01:59<07:53, 59.16s/it, Train Loss=0.0041, Validation Loss=0.0044, correlation : =0.7042, cosin correlation : =0.9645, gap : =29.6052] 20%|██        | 2/10 [02:57<07:53, 59.16s/it, Train Loss=0.0040, Validation Loss=0.0042, correlation : =0.7061, cosin correlation : =0.9647, gap : =29.2573] 30%|███       | 3/10 [02:57<06:49, 58.50s/it, Train Loss=0.0040, Validation Loss=0.0042, correlation : =0.7061, cosin correlation : =0.9647, gap : =29.2573] 30%|███       | 3/10 [03:54<06:49, 58.50s/it, Train Loss=0.0040, Validation Loss=0.0040, correlation : =0.7122, cosin correlation : =0.9656, gap : =26.0450] 40%|████      | 4/10 [03:54<05:48, 58.13s/it, Train Loss=0.0040, Validation Loss=0.0040, correlation : =0.7122, cosin correlation : =0.9656, gap : =26.0450] 40%|████      | 4/10 [04:52<05:48, 58.13s/it, Train Loss=0.0040, Validation Loss=0.0039, correlation : =0.7143, cosin correlation : =0.9659, gap : =25.1441] 50%|█████     | 5/10 [04:52<04:50, 58.14s/it, Train Loss=0.0040, Validation Loss=0.0039, correlation : =0.7143, cosin correlation : =0.9659, gap : =25.1441] 50%|█████     | 5/10 [05:51<04:50, 58.14s/it, Train Loss=0.0040, Validation Loss=0.0041, correlation : =0.7102, cosin correlation : =0.9654, gap : =24.5949] 60%|██████    | 6/10 [05:51<03:52, 58.23s/it, Train Loss=0.0040, Validation Loss=0.0041, correlation : =0.7102, cosin correlation : =0.9654, gap : =24.5949] 60%|██████    | 6/10 [06:48<03:52, 58.23s/it, Train Loss=0.0039, Validation Loss=0.0040, correlation : =0.7146, cosin correlation : =0.9659, gap : =26.0268] 70%|███████   | 7/10 [06:48<02:54, 58.02s/it, Train Loss=0.0039, Validation Loss=0.0040, correlation : =0.7146, cosin correlation : =0.9659, gap : =26.0268] 70%|███████   | 7/10 [07:46<02:54, 58.02s/it, Train Loss=0.0039, Validation Loss=0.0044, correlation : =0.7045, cosin correlation : =0.9648, gap : =23.5834] 80%|████████  | 8/10 [07:46<01:55, 57.86s/it, Train Loss=0.0039, Validation Loss=0.0044, correlation : =0.7045, cosin correlation : =0.9648, gap : =23.5834] 80%|████████  | 8/10 [08:43<01:55, 57.86s/it, Train Loss=0.0039, Validation Loss=0.0163, correlation : =0.5448, cosin correlation : =0.9046, gap : =61.0246] 80%|████████  | 8/10 [08:43<02:10, 65.49s/it, Train Loss=0.0039, Validation Loss=0.0163, correlation : =0.5448, cosin correlation : =0.9046, gap : =61.0246]
best args :  Namespace(data_dir=PosixPath('../tsp_n5900'), tb_dir=PosixPath('../model_result_n5900'), embed_dim=128, embed_dim2=128, n_layers=4, n_heads=16, lr_init=0.001, lr_decay=0.9, min_delta=0.0001, patience=5, batch_size=15, n_epochs=10, checkpoint_freq=1, target='regret', use_gpu=True, embd_dim2=128, kj='cat')
